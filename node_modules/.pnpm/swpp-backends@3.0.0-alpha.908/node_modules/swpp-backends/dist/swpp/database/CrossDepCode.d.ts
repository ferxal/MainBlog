import { UpdateChangeExp } from '../JsonBuilder';
import { FunctionInBrowser } from './RuntimeDepCode';
import { RuntimeKeyValueDatabase } from './RuntimeKeyValueDatabase';
/**
 * 同时在 Node 和浏览器中运行的代码
 */
export interface FunctionInBrowserAndNode<Args extends any[], R> {
    runOnBrowser: FunctionInBrowser<Args, R>;
    runOnNode: (...args: Args) => R;
}
export type COMMON_TYPE_CROSS_DEP = ReturnType<typeof buildCommon>;
/**
 * 运行时和生成时都依赖的代码
 */
export declare class CrossDepCode extends RuntimeKeyValueDatabase<FunctionInBrowserAndNode<any, any>, COMMON_TYPE_CROSS_DEP> {
    constructor();
    /** 构建 JS 源代码 */
    buildJsSource(): string;
    /**
     * 构建一个在浏览器和 Node 中都执行的函数
     */
    static buildBothFunction<Args extends any[], R>(action: (...args: Args) => R): FunctionInBrowserAndNode<Args, R>;
}
declare function buildCommon(): {
    /** 检查请求是否成功 */
    readonly isFetchSuccessful: {
        readonly default: FunctionInBrowserAndNode<[response: Response], boolean>;
    };
    /** 缓存规则 */
    readonly matchCacheRule: {
        readonly default: FunctionInBrowserAndNode<[_url: URL], number | false | symbol | null | undefined>;
    };
    /** 归一化 URL */
    readonly normalizeUrl: {
        readonly default: FunctionInBrowserAndNode<[url: string], string>;
    };
    /** 匹配缓存更新规则 */
    readonly matchUpdateRule: {
        readonly default: FunctionInBrowserAndNode<[exp: UpdateChangeExp], (url: string) => boolean | undefined | null>;
    };
};
export {};
